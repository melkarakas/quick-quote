<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Modern Quick Quote Calculator</title>
    <!-- Bootstrap CSS for basic styling -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" />
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&display=swap" rel="stylesheet" />
    <!-- Inline CSS -->
    <style>
      /* Global Styles */
      body {
        font-family: "Montserrat", sans-serif;
        background: #f5f7fa;
        margin: 0;
        padding: 20px;
        color: #333;
      }
      .calculator-container {
        max-width: 1000px;
        margin: 50px auto;
        background: #fff;
        border-radius: 15px;
        padding: 40px 30px;
        box-shadow: 0 8px 30px rgba(0, 0, 0, 0.12);
      }
      .calculator-container h2 {
        font-weight: 700;
        margin-bottom: 30px;
        color: #000;
        text-align: center;
      }
      .form-control {
        border-radius: 10px;
        border: 1px solid #e0e0e0;
        font-size: 1rem;
      }
      .form-control:focus {
        border-color: #F1B84B;
        box-shadow: 0 0 0 0.2rem rgba(241, 184, 75, 0.25);
      }
      .form-group label {
        font-weight: 600;
      }
      .btn-custom {
        background-color: #F1B84B;
        border: none;
        border-radius: 10px;
        padding: 12px 20px;
        font-size: 1rem;
        font-weight: 600;
        color: #fff;
        transition: background-color 0.3s ease;
      }
      .btn-custom:hover {
        background-color: #d1a13b;
      }
      .btn-custom-sm {
        background-color: #F1B84B;
        border: none;
        border-radius: 8px;
        padding: 8px 16px;
        font-size: 0.85rem;
        font-weight: 600;
        color: #fff;
        transition: background-color 0.3s ease;
      }
      .btn-custom-sm:hover {
        background-color: #d1a13b;
      }
      .project-card, .feature-card {
        position: relative;
        cursor: pointer;
        border: 1px solid #e0e0e0;
        border-radius: 10px;
        transition: all 0.3s ease;
        height: 150px;
        background-size: cover;
        background-position: center;
        background-repeat: no-repeat;
        overflow: hidden;
      }
      .project-card:hover, .feature-card:hover {
        border-color: #F1B84B;
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
      }
      .selected {
        border-color: #F1B84B;
        border-width: 3px;
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
      }
      .card-overlay {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.4);
        border-radius: 10px;
        z-index: 1;
      }
      .card .card-body {
        position: relative;
        z-index: 2;
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100%;
        padding: 10px;
        text-align: center;
      }
      .card .card-title {
        font-size: clamp(0.8rem, 1.5vw, 1.2rem);
        margin: 0;
        color: #fff;
        word-wrap: break-word;
      }
      .nav-back { margin-bottom: 20px; }
      .quote-display h4 { font-weight: 700; color: #000; }
      .quote-display p { font-size: 1.75rem; font-weight: 700; color: #F1B84B; }
      .contact-info-section, .mb-3 { margin-bottom: 30px; }
      h5, h6 { color: #000; }
    </style>
  </head>
  <body>
    <div id="app" class="calculator-container">
      <h2>Quick Quote Calculator</h2>
      <!-- Step 1: Contact Information -->
      <div v-if="currentStep === 1">
        <div class="contact-info-section">
          <h5>Contact Information</h5>
          <div class="form-group">
            <label for="firstName">First Name</label>
            <input type="text" id="firstName" class="form-control" v-model="firstName" placeholder="Enter your first name" />
          </div>
          <div class="form-group">
            <label for="lastName">Last Name</label>
            <input type="text" id="lastName" class="form-control" v-model="lastName" placeholder="Enter your last name" />
          </div>
          <div class="form-group">
            <label for="email">Email</label>
            <input type="email" id="email" class="form-control" v-model="email" placeholder="Enter your email" />
          </div>
          <div class="form-group">
            <label for="phone">Phone Number</label>
            <input type="tel" id="phone" class="form-control" v-model="phone" placeholder="Enter your phone number" />
          </div>
        </div>
        <button type="button" class="btn btn-custom btn-block" @click="nextStep">Next</button>
      </div>
      <!-- Step 2: Project Type Selection -->
      <div v-if="currentStep === 2">
        <div class="nav-back">
          <button type="button" class="btn btn-custom-sm" @click="goBack">&laquo; Back</button>
        </div>
        <p class="mb-3 font-weight-bold">Select a project type:</p>
        <div class="row">
          <div class="col-md-4 mb-3" v-for="option in projectOptions" :key="option.value">
            <div class="card project-card" :class="{ selected: projectType === option.value }" @click="selectProject(option.value)" :style="{ backgroundImage: 'url(' + option.image + ')' }">
              <div class="card-overlay"></div>
              <div class="card-body">
                <h5 class="card-title">{{ option.label }}</h5>
              </div>
            </div>
          </div>
        </div>
        <div v-if="projectType">
          <button type="button" class="btn btn-custom btn-block" @click="nextStep">Next</button>
        </div>
      </div>
      <!-- Step 3: Project Details & Quote Calculation -->
      <div v-if="currentStep === 3">
        <div class="nav-back">
          <button type="button" class="btn btn-custom-sm" @click="goBack">&laquo; Back</button>
        </div>
        <!-- If Basement Finishing, show specialized questions -->
        <div v-if="projectType === 'basement'">
          <h5>Basement Finishing Details</h5>
          <div class="form-group">
            <label for="area">What size is your basement? (sqft)</label>
            <input type="number" id="area" class="form-control" v-model="area" placeholder="Enter basement size in sqft" />
          </div>
          <!-- Interior Features as Card Selections -->
          <div class="mb-3">
            <h6>Select Interior Features:</h6>
            <div class="row">
              <div class="col-md-3 mb-3" v-for="option in interiorOptions" :key="option.value">
                <div class="card feature-card" :class="{ selected: interiorFeatures.includes(option.value) }" @click="toggleInterior(option.value)" :style="{ backgroundImage: 'url(' + option.image + ')' }">
                  <div class="card-overlay"></div>
                  <div class="card-body">
                    <h6 class="card-title">{{ option.label }}</h6>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <!-- Exterior Features as Card Selections -->
          <div class="mb-3">
            <h6>Select Exterior Features:</h6>
            <div class="row">
              <div class="col-md-3 mb-3" v-for="option in exteriorOptions" :key="option.value">
                <div class="card feature-card" :class="{ selected: exteriorFeatures.includes(option.value) }" @click="toggleExterior(option.value)" :style="{ backgroundImage: 'url(' + option.image + ')' }">
                  <div class="card-overlay"></div>
                  <div class="card-body">
                    <h6 class="card-title">{{ option.label }}</h6>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <!-- Flooring as Card Selections -->
          <div class="mb-3">
            <h6>Select Flooring:</h6>
            <div class="row">
              <div class="col-md-3 mb-3" v-for="option in flooringOptions" :key="option.value">
                <div class="card feature-card" :class="{ selected: flooring === option.value }" @click="selectFlooring(option.value)" :style="{ backgroundImage: 'url(' + option.image + ')' }">
                  <div class="card-overlay"></div>
                  <div class="card-body">
                    <h6 class="card-title">{{ option.label }}</h6>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <button type="button" class="btn btn-custom btn-block" @click="calculateQuote">Calculate Quote</button>
        </div>
        <!-- For Other Project Types: Generic Fields -->
        <div v-else>
          <div v-if="projectType">
            <p class="mb-3 font-weight-bold">Project Type: {{ getProjectLabel(projectType) }}</p>
          </div>
          <div class="form-group">
            <label for="area">Area (in square feet)</label>
            <input type="number" id="area" class="form-control" v-model="area" placeholder="Enter area in square feet" />
          </div>
          <div class="form-group">
            <label for="finish">Finish Quality</label>
            <select id="finish" class="form-control" v-model="finish">
              <option value="">Select finish quality</option>
              <option value="basic">Basic</option>
              <option value="standard">Standard</option>
              <option value="premium">Premium</option>
            </select>
          </div>
          <div v-if="projectType === 'kitchen' || projectType === 'bathroom'" class="form-group">
            <label for="additional">Additional Options (Number of extra fixtures/upgrades)</label>
            <input type="number" id="additional" class="form-control" v-model.number="additional" placeholder="0" />
          </div>
          <button type="button" class="btn btn-custom btn-block" @click="calculateQuote">Calculate Quote</button>
        </div>
        <!-- Display the Calculated Quote -->
        <div v-if="quote !== null" class="quote-display mt-4 text-center">
          <h4>Your Estimated Project Quote:</h4>
          <p>{{ formatCurrency(quote) }}</p>
        </div>
        <!-- Pricing Breakdown Toggle -->
        <div v-if="quote !== null" class="mt-4 text-center">
          <button type="button" class="btn btn-custom btn-block" @click="showBreakdown = !showBreakdown">
            {{ showBreakdown ? "Hide" : "Show" }} Pricing Breakdown
          </button>
        </div>
        <div v-if="showBreakdown" class="mt-3">
          <p><strong>Base Cost:</strong> {{ formatCurrency(baseCost) }}</p>
          <p><strong>Interior Features Cost:</strong> {{ formatCurrency(interiorCost) }}</p>
          <p><strong>Exterior Features Cost:</strong> {{ formatCurrency(exteriorCost) }}</p>
          <p><strong>Total:</strong> {{ formatCurrency(quote) }}</p>
        </div>
        <!-- Submit Request Button -->
        <div v-if="quote !== null" class="mt-4 text-center">
          <button type="button" class="btn btn-custom btn-block" @click="submitRequest">Submit Request</button>
        </div>
      </div>
    </div>
    <!-- Load Vue.js from CDN -->
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
    <script>
      new Vue({
        el: "#app",
        data: {
          currentStep: 1,
          firstName: "",
          lastName: "",
          email: "",
          phone: "",
          projectType: "",
          area: "",
          finish: "",
          additional: 0,
          quote: null,
          baseCost: 0,
          interiorCost: 0,
          exteriorCost: 0,
          showBreakdown: false,
          interiorFeatures: [],
          exteriorFeatures: [],
          flooring: "",
          projectOptions: [
            { value: "basement", label: "Basement Finishing", image: "https://rockdale.ca/wp-content/uploads/2024/02/Copy-of-2CRIK89X15F7-scaled.jpg" },
            { value: "kitchen", label: "Kitchen Renovation", image: "https://rockdale.ca/wp-content/uploads/2024/12/45-IMG_6376.jpg" },
            { value: "bathroom", label: "Bathroom Renovation", image: "https://rockdale.ca/wp-content/uploads/2024/02/Copy-of-22D48NHQ09EV-scaled.jpg" },
            { value: "custom-home", label: "Custom Home", image: "https://rockdale.ca/wp-content/uploads/2024/12/04-IMG_6413.jpg" },
            { value: "fht", label: "Full Home Transformation", image: "https://rockdale.ca/wp-content/uploads/2024/12/16-IMG_6289.jpg" },
            { value: "interiorDesign", label: "Interior Design", image: "https://rockdale.ca/wp-content/uploads/2024/12/16-IMG_6289.jpg" }
          ],
          interiorOptions: [
            { value: "bedroom", label: "Bedroom", image: "https://webphotos.blob.core.windows.net/photos/39-IMG_6358.jpg" },
            { value: "bathroom", label: "Bathroom", image: "https://rockdale.ca/wp-content/uploads/2024/02/Copy-of-22D49TG4WAV8-scaled.jpg" },
            { value: "fullKitchen", label: "Full Kitchen", image: "https://rockdale.ca/wp-content/uploads/2024/02/Copy-of-22D49KF4DMGC-1-scaled.jpg" },
            { value: "wetbar", label: "Wetbar", image: "https://webphotos.blob.core.windows.net/photos/replicate-prediction-yszz5wam6hrge0cmtzs8w65q0m.png" }
          ],
          exteriorOptions: [
            { value: "undergroundDoor", label: "Underground Door Opening", image: "https://webphotos.blob.core.windows.net/photos/IMG_2345.jpg" },
            { value: "aboveGroundDoor", label: "Above Ground Door Opening", image: "https://webphotos.blob.core.windows.net/photos/IMG_1398.jpeg" },
            { value: "egressWindow", label: "New Egress Window", image: "https://webphotos.blob.core.windows.net/photos/Basement-EGRESS-6.jpg" }
          ],
          flooringOptions: [
            { value: "Hardwood", label: "Hardwood", image: "https://webphotos.blob.core.windows.net/photos/everwood-designer-plus-barossa-2-e1669668217311-1-1-2.jpg" },
            { value: "Vinyl", label: "Vinyl", image: "https://webphotos.blob.core.windows.net/photos/42005-469-swatch.jpg" },
            { value: "Carpet", label: "Carpet", image: "https://webphotos.blob.core.windows.net/photos/shopping.jpeg" }
          ]
        },
        methods: {
          nextStep() {
            if (this.currentStep === 1) {
              if (!this.firstName || !this.lastName || !this.email || !this.phone) {
                alert("Please fill out all contact information fields.");
                return;
              }
              this.currentStep = 2;
            } else if (this.currentStep === 2) {
              if (!this.projectType) {
                alert("Please select a project type.");
                return;
              }
              this.currentStep = 3;
            }
          },
          goBack() {
            if (this.currentStep > 1) this.currentStep--;
          },
          selectProject(value) {
            this.projectType = value;
            // Reset fields when project type changes
            this.area = "";
            this.finish = "";
            this.additional = 0;
            this.quote = null;
            this.interiorFeatures = [];
            this.exteriorFeatures = [];
            this.flooring = "";
            this.baseCost = 0;
            this.interiorCost = 0;
            this.exteriorCost = 0;
            this.showBreakdown = false;
          },
          getProjectLabel(value) {
            const option = this.projectOptions.find(opt => opt.value === value);
            return option ? option.label : "";
          },
          toggleInterior(feature) {
            const index = this.interiorFeatures.indexOf(feature);
            if (index > -1) this.interiorFeatures.splice(index, 1);
            else this.interiorFeatures.push(feature);
          },
          toggleExterior(feature) {
            if (["undergroundDoor", "aboveGroundDoor"].includes(feature)) {
              this.exteriorFeatures = this.exteriorFeatures.filter(
                f => !(["undergroundDoor", "aboveGroundDoor"].includes(f) && f !== feature)
              );
            }
            const index = this.exteriorFeatures.indexOf(feature);
            if (index > -1) this.exteriorFeatures.splice(index, 1);
            else this.exteriorFeatures.push(feature);
          },
          selectFlooring(value) {
            this.flooring = value;
          },
          calculateQuote() {
            if (this.projectType === "basement") {
              const size = parseFloat(this.area);
              if (isNaN(size) || size < 350 || size > 1250) {
                alert("Please enter a valid basement size (between 350 and 1250 sqft).");
                return;
              }
              let rate = 0;
              if (size >= 350 && size < 450) rate = 50;
              else if (size >= 450 && size < 650) rate = 48;
              else if (size >= 650 && size < 850) rate = 49;
              else if (size >= 850 && size < 1050) rate = 40;
              else if (size >= 1050 && size <= 1250) rate = 40;
              this.baseCost = size * rate;
              let interiorCost = 0;
              const interiorPrices = { bedroom: 4000, bathroom: 12000, fullKitchen: 6500, wetbar: 4000 };
              this.interiorFeatures.forEach(feature => { if (interiorPrices[feature]) interiorCost += interiorPrices[feature]; });
              this.interiorCost = interiorCost;
              let exteriorCost = 0;
              const exteriorPrices = { undergroundDoor: 30000, aboveGroundDoor: 15000, egressWindow: 3000 };
              this.exteriorFeatures.forEach(feature => { if (exteriorPrices[feature]) exteriorCost += exteriorPrices[feature]; });
              this.exteriorCost = exteriorCost;
              this.quote = this.baseCost + this.interiorCost + this.exteriorCost;
            } else {
              const numericArea = parseFloat(this.area);
              if (isNaN(numericArea) || numericArea <= 0) {
                alert("Please enter a valid area in square feet.");
                return;
              }
              if (!this.projectType) {
                alert("Please select a project type.");
                return;
              }
              if (!this.finish) {
                alert("Please select a finish quality.");
                return;
              }
              const baseRate = this.rates[this.projectType][this.finish];
              let total = numericArea * baseRate;
              if (this.projectType === "kitchen" || this.projectType === "bathroom") {
                total += this.additional * 500;
              }
              this.quote = total;
            }
          },
          formatCurrency(amount) {
            return amount.toLocaleString('en-US', { style: 'currency', currency: 'USD' });
          },
          submitRequest() {
            // Prepare form data to send to the server
            const formData = new FormData();
            formData.append('action', 'submit_request');
            formData.append('firstName', this.firstName);
            formData.append('lastName', this.lastName);
            formData.append('email', this.email);
            formData.append('phone', this.phone);
            formData.append('projectType', this.getProjectLabel(this.projectType));
            formData.append('area', this.area);
            formData.append('finish', this.finish);
            formData.append('additional', this.additional);
            formData.append('interiorFeatures', this.interiorFeatures.join(", "));
            formData.append('exteriorFeatures', this.exteriorFeatures.join(", "));
            formData.append('flooring', this.flooring);
            formData.append('quote', this.formatCurrency(this.quote));
            formData.append('baseCost', this.formatCurrency(this.baseCost));
            formData.append('interiorCost', this.formatCurrency(this.interiorCost));
            formData.append('exteriorCost', this.formatCurrency(this.exteriorCost));
            
            // Send the POST request to this same PHP file
            fetch("", {
              method: "POST",
              body: formData
            })
            .then(response => response.json())
            .then(data => {
              if(data.success) {
                alert("Your request has been submitted successfully!");
                this.resetForm();
              } else {
                alert("There was an error submitting your request. Please try again later.");
              }
            })
            .catch(error => {
              console.error("Error:", error);
              alert("There was an error submitting your request. Please try again later.");
            });
          },
          resetForm() {
            this.currentStep = 1;
            this.firstName = "";
            this.lastName = "";
            this.email = "";
            this.phone = "";
            this.projectType = "";
            this.area = "";
            this.finish = "";
            this.additional = 0;
            this.quote = null;
            this.interiorFeatures = [];
            this.exteriorFeatures = [];
            this.flooring = "";
            this.baseCost = 0;
            this.interiorCost = 0;
            this.exteriorCost = 0;
            this.showBreakdown = false;
          }
        }
      });
    </script>
  </body>
</html>
